<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>아이(i)들 응원하기</title>
    <link rel="stylesheet" href="./cheerMsgStyle.css" />
  </head>
  <body>
    <!-- 한별님 응원글 모아보기 페이지 div -->

    <script src="./cheerMsgScript.js"></script>
  </body>
</html>
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>아이(i)들 응원하기</title>
    <link rel="stylesheet" href="./cheerMsgStyle.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script type="module">
    // Firebase SDK 라이브러리 가져오기
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
import { getFirestore } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
import { collection, addDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
import { getDocs } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";


// Firebase 구성 정보 설정
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyARSXdnR-sYaYQoLLhBqv8rPXm2jjJCGTg",
  authDomain: "sparta-90ed7.firebaseapp.com",
  projectId: "sparta-90ed7",
  storageBucket: "sparta-90ed7.appspot.com",
  messagingSenderId: "1044334782358",
  appId: "1:1044334782358:web:526856c1acc33834de5fb7",
  measurementId: "G-JDZS19KRQL"
};


// Firebase 인스턴스 초기화
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const reviewRef = collection(db, 'movies');
let reviewList = [];


// const people = [
//     {'name':'김한별','text':'안녕하세요. 화이팅하세요!'},
//     {'name':'봉구','text':'화이팅 하세요. 반갑습니다. 반갑습니다. 반갑습니다.'},
//     {'name':'토리','text':'대한'},
//     {'name':'김룰루','text':'민국'},
//     {'name':'이랄라','text':'만세'},
//     {'name':'이잼잼','text':'새로운 변수입니다.'},
//     {'name':'최신나','text':'야호'}
// ];

getDocs( reviewRef)
  .then((querySnapshot) => {
    querySnapshot.forEach((doc) => {
      let reviewData = {
        name: doc.data().name,
        comment: doc.data().comment
      };
      reviewList.push(reviewData);
    });
    console.log(reviewList);
    displayReviews(reviewList);
  })
  .catch((error) => {
    console.error('Error getting documents: ', error);
  });


    function displayReviews(reviewList) {
    // $(document).ready(function(){
        reviewList.forEach(function(review, order) {
            // 짝수번째일 때는 yours 클래스, 홀수번째일 때는 mine 클래스
            const className = order % 2 === 0 ? 'yours' : 'mine';
            const temp_html = `<div class="${className} messages">
                                
                                <div class="message last">
                                    <h3 class="name">${review.name}</h3>
                                    <p class="text">${review.comment}</p>
                                </div>
                                <div class="buttons">
                                    <input type="button" class="editButton btn btn-light btn-sm" value="수정"/> 
                                    <input type="button" class="deleteButton btn btn-light btn-sm" value="삭제"/>
                                </div>
                            </div>`;
            $('.review').append(temp_html);
        });

  }
  
// });

  

    // 수정 버튼
    $(document).on("click", ".editButton", function() {
        const messageDiv = $(this).closest(".messages");
        const textDiv = messageDiv.find(".text");
        const newText = prompt("수정할 내용을 입력하세요", textDiv.text());
        
        if (newText !== null && newText.trim() !== "") {
            textDiv.text(newText);
            alert('수정되었습니다.');
        } else {
            alert('내용을 입력하세요.');
        }
    });
    
    // 삭제 버튼
    $(document).on("click", ".deleteButton", function() {
        if(confirm('응원글을 정말 삭제하시겠습니까?')){
            $(this).closest(".messages").remove();
            alert('삭제되었습니다.');
        }
    });




  </script>



</head>
  <body>
    <!-- 한별님 응원글 모아보기 페이지 div -->
    <h1 class="title">응원의 한마디</h1>
    <div class="review">
      
  
  </body>
</html>
